{{ 'custom-card-carousel.css' | asset_url | stylesheet_tag }}
<script src="{{ 'custom-card-carousel.js' | asset_url }}" defer="defer"></script>

{%- liquid
  assign items_per_row = section.settings.items_per_row
  assign heading = section.settings.heading
  assign container_class = 'container'
  if section.settings.container_type == 'full_width'
    assign container_class = 'container-fluid'
  endif
-%}

<style>
  #shopify-section-{{ section.id }} .m-custom-card-carousel__title {
    font-size: {{ section.settings.heading_size }}px;
    font-weight: {{ section.settings.heading_weight }};
  }
  #shopify-section-{{ section.id }} .m-custom-card-carousel__header-text {
    font-size: {{ section.settings.card_header_size }}px;
    font-weight: {{ section.settings.card_header_weight }};
  }
  #shopify-section-{{ section.id }} .m-custom-card-carousel__subheader-text {
    font-size: {{ section.settings.card_subheader_size }}px;
    font-weight: {{ section.settings.card_subheader_weight }};
  }
</style>

<section class="m-section m-custom-card-carousel" data-section-id="{{ section.id }}" style="padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;">
  <div class="{{ container_class }}">
    {% if heading != blank %}
      <div class="m-custom-card-carousel__header">
        <h2 class="m-custom-card-carousel__title">{{ heading }}</h2>
      </div>
    {% endif %}

    <m-custom-card-carousel
      data-items="{{ items_per_row }}"
      data-autoplay="{{ section.settings.autoplay }}"
      data-autoplay-speed="{{ section.settings.autoplay_speed }}"
      data-show-navigation="{{ section.settings.show_navigation }}"
      data-show-pagination="{{ section.settings.show_pagination }}"
      class="m:block"
    >
      <div class="swiper-container">
        <div class="swiper-wrapper">
          {% for block in section.blocks %}
            <div class="swiper-slide" {{ block.shopify_attributes }}>
              {%- if block.settings.link != blank -%}
                <a href="{{ block.settings.link }}" class="m-custom-card-carousel__card m-custom-card-carousel__card--link">
              {%- else -%}
                <div class="m-custom-card-carousel__card">
              {%- endif -%}
              
                <div class="m-custom-card-carousel__image-wrapper">
                  {% if block.settings.image != blank %}
                    {{ block.settings.image | image_url: width: 600 | image_tag: class: 'm-custom-card-carousel__image', loading: 'lazy' }}
                  {% else %}
                    <div class="m-custom-card-carousel__image-placeholder">
                      {{ 'image' | placeholder_svg_tag }}
                    </div>
                  {% endif %}
                </div>
                {% if block.settings.header_text != blank %}
                  <div class="m-custom-card-carousel__header-text">{{ block.settings.header_text }}</div>
                {% endif %}
                {% if block.settings.subheader_text != blank %}
                  <div class="m-custom-card-carousel__subheader-text">{{ block.settings.subheader_text }}</div>
                {% endif %}

              {%- if block.settings.link != blank -%}
                </a>
              {%- else -%}
                </div>
              {%- endif -%}
            </div>
          {% endfor %}
        </div>
        {% if section.settings.show_navigation %}
          <div class="swiper-button-prev m-custom-card-carousel__arrow">
             <svg color="currentColor" fill="none" focusable="false" height="24px" viewBox="0 0 24 24" width="24px" style="transform: rotate(180deg);"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="square"><g stroke="currentColor" stroke-width="1"><polyline vector-effect="non-scaling-stroke" points="8 3.29999995 16.8163452 11.8633058 8 20.5598266"></polyline></g></g></svg>
          </div>
          <div class="swiper-button-next m-custom-card-carousel__arrow">
             <svg color="currentColor" fill="none" focusable="false" height="24px" viewBox="0 0 24 24" width="24px"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="square"><g stroke="currentColor" stroke-width="1"><polyline vector-effect="non-scaling-stroke" points="8 3.29999995 16.8163452 11.8633058 8 20.5598266"></polyline></g></g></svg>
          </div>
        {% endif %}
        {% if section.settings.show_pagination %}
          <div class="swiper-pagination"></div>
        {% endif %}
      </div>
    </m-custom-card-carousel>
  </div>
</section>

{% schema %}
{
  "name": "Custom Card Carousel",
  "settings": [
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "select",
      "id": "container_type",
      "label": "Container type",
      "options": [
        {
          "value": "container",
          "label": "Container box"
        },
        {
          "value": "full_width",
          "label": "Full width"
        }
      ],
      "default": "container"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Best Brands, Unbeatable Savings!"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "paragraph",
      "content": "Section Heading"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 16,
      "max": 60,
      "step": 1,
      "unit": "px",
      "label": "Heading Font Size",
      "default": 24
    },
    {
      "type": "select",
      "id": "heading_weight",
      "label": "Heading Font Weight",
      "options": [
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "SemiBold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "600"
    },
    {
      "type": "paragraph",
      "content": "Card Header"
    },
    {
      "type": "range",
      "id": "card_header_size",
      "min": 12,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Card Header Size",
      "default": 16
    },
    {
      "type": "select",
      "id": "card_header_weight",
      "label": "Card Header Weight",
      "options": [
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "SemiBold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "700"
    },
    {
      "type": "paragraph",
      "content": "Card Subheader"
    },
    {
      "type": "range",
      "id": "card_subheader_size",
      "min": 10,
      "max": 30,
      "step": 1,
      "unit": "px",
      "label": "Card Subheader Size",
      "default": 14
    },
    {
      "type": "select",
      "id": "card_subheader_weight",
      "label": "Card Subheader Weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "SemiBold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "400"
    },
    {
      "type": "header",
      "content": "Carousel Settings"
    },
    {
      "type": "range",
      "id": "items_per_row",
      "min": 2,
      "max": 6,
      "step": 1,
      "label": "Items per row (Desktop)",
      "default": 4
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Enable Autoplay",
      "default": false
    },
    {
      "type": "range",
      "id": "autoplay_speed",
      "min": 2,
      "max": 10,
      "step": 1,
      "unit": "s",
      "label": "Autoplay Speed",
      "default": 5
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "label": "Show Navigation Arrows",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_pagination",
      "label": "Show Pagination",
      "default": false
    },
    {
      "type": "header",
      "content": "Section Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top Padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom Padding",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "header_text",
          "label": "Header",
          "default": "25% OFF"
        },
        {
          "type": "text",
          "id": "subheader_text",
          "label": "Subheader",
          "default": "All styles"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Card Carousel",
      "category": "Image",
      "blocks": [
        {
          "type": "card"
        },
        {
          "type": "card"
        },
        {
          "type": "card"
        },
        {
          "type": "card"
        }
      ]
    }
  ]
}
{% endschema %}