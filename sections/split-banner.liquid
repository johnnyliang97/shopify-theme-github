{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .split-banner-{{ section.id }} {
    background-color: {{ section.settings.background_color }};
  }
  
  .split-banner-content {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: {{ section.settings.content_alignment }};
      text-align: {{ section.settings.content_alignment | replace: 'flex-start', 'left' | replace: 'flex-end', 'right' }};
      padding: 2rem;
      box-sizing: border-box;
  }
  
  .split-banner-image {
      aspect-ratio: 1 / 1;
      object-fit: cover;
      width: 100%;
      height: 100%;
      display: block;
  }

  .split-banner-image-link {
      display: block;
      width: 100%;
      height: 100%;
  }
  
  .split-banner-buttons {
      margin-top: 2rem;
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      justify-content: {{ section.settings.content_alignment }};
  }

  .split-banner-buttons a {
      padding: 8px 16px !important;
      font-size: 12px !important;
      font-weight: 600 !important;
      line-height: 1.2 !important;
      border-radius: 8px !important;
  }

  /* Desktop layout */
  @media screen and (min-width: 768px) {
      .split-banner-wrapper {
          display: flex;
          align-items: stretch;
          flex-direction: {% if section.settings.image_position == 'right' %}row-reverse{% else %}row{% endif %};
      }
      .split-banner-half {
          width: 50%;
      }
  }
  
  /* Mobile layout */
  @media screen and (max-width: 767px) {
      .split-banner-wrapper {
          display: flex;
          flex-direction: column;
      }
      .split-banner-half {
          width: 100%;
      }
      /* Image on top for mobile */
      .split-banner-image-container {
          order: -1;
      }
      /* Force full width container on mobile */
      .split-banner-container {
          width: 100% !important;
          max-width: 100% !important;
          padding-left: 0 !important;
          padding-right: 0 !important;
          margin-left: 0 !important;
          margin-right: 0 !important;
      }
  }
{%- endstyle -%}

{%- assign container_class = 'container-fluid' -%}
{%- if section.settings.container == 'container' -%}
  {%- assign container_class = 'container' -%}
{%- elsif section.settings.container == 'w-full' -%}
  {%- assign container_class = 'w-full' -%}
{%- endif -%}

<div class="split-banner-{{ section.id }} section-{{ section.id }}-padding">
  <div class="{{ container_class }} split-banner-container">
    <div class="split-banner-wrapper">
      <div class="split-banner-half split-banner-image-container">
        {%- if section.settings.image_link != blank -%}
          <a href="{{ section.settings.image_link }}" class="split-banner-image-link">
        {%- endif -%}
        {%- if section.settings.image != blank -%}
          {{ section.settings.image | image_url: width: 1500 | image_tag:
            loading: 'lazy',
            class: 'split-banner-image',
            widths: '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840'
          }}
        {%- else -%}
          {{ 'image' | placeholder_svg_tag: 'placeholder-svg split-banner-image' }}
        {%- endif -%}
        {%- if section.settings.image_link != blank -%}
          </a>
        {%- endif -%}
      </div>
      <div class="split-banner-half split-banner-content">
        {%- if section.settings.title_type == 'text' -%}
          <h2 class="{{ section.settings.title_size }}" style="color: {{ section.settings.text_color }}; margin: 0;">
            {{ section.settings.title_text }}
          </h2>
        {%- else -%}
          {%- if section.settings.title_image != blank -%}
            {%- assign image_width_2x = section.settings.title_image_width | times: 2 -%}
            {{ section.settings.title_image | image_url: width: image_width_2x | image_tag: loading: 'lazy', style: 'max-width: 100%; height: auto;', width: section.settings.title_image_width }}
          {%- endif -%}
        {%- endif -%}

        <div class="{{ section.settings.subheader_size }}" style="color: {{ section.settings.text_color }}; margin-top: 1rem;">
          {{ section.settings.subheader_text }}
        </div>

        <div class="split-banner-buttons">
          {%- for block in section.blocks -%}
            {%- if block.type == 'button' -%}
              <a href="{{ block.settings.link }}" class="m-button {{ block.settings.button_style }}">
                {{ block.settings.label }}
              </a>
            {%- endif -%}
          {%- endfor -%}
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Split Banner",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "container",
      "label": "Container type",
      "default": "container-fluid",
      "options": [
        {
          "value": "container-fluid",
          "label": "Default"
        },
        {
          "value": "container",
          "label": "Use container box"
        },
        {
          "value": "w-full",
          "label": "Full width"
        }
      ]
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Banner Image"
    },
    {
      "type": "url",
      "id": "image_link",
      "label": "Banner Link"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "Desktop Image Position",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
        "type": "select",
        "id": "content_alignment",
        "label": "Content Alignment",
        "options": [
            { "value": "flex-start", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "flex-end", "label": "Right" }
        ],
        "default": "center"
    },
    {
      "type": "header",
      "content": "Title"
    },
    {
      "type": "select",
      "id": "title_type",
      "label": "Title Type",
      "options": [
        { "value": "text", "label": "Text" },
        { "value": "image", "label": "Image" }
      ],
      "default": "text"
    },
    {
      "type": "text",
      "id": "title_text",
      "label": "Title Text",
      "default": "Banner Title"
    },
    {
      "type": "select",
      "id": "title_size",
      "label": "Title Text Size",
      "options": [
        { "value": "h3", "label": "Small" },
        { "value": "h2", "label": "Medium" },
        { "value": "h1", "label": "Large" }
      ],
      "default": "h2"
    },
    {
      "type": "image_picker",
      "id": "title_image",
      "label": "Title Image"
    },
    {
        "type": "number",
        "id": "title_image_width",
        "label": "Title Image Width (px)",
        "default": 300
    },
    {
      "type": "header",
      "content": "Subheader"
    },
    {
      "type": "richtext",
      "id": "subheader_text",
      "label": "Subheader Text",
      "default": "<p>Subheader text goes here</p>"
    },
    {
        "type": "select",
        "id": "subheader_size",
        "label": "Subheader Size",
        "options": [
            { "value": "text-sm", "label": "Small" },
            { "value": "text-base", "label": "Medium" },
            { "value": "text-lg", "label": "Large" },
            { "value": "h4", "label": "Extra Large" }
        ],
        "default": "text-base"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 0
    }
  ],
  "blocks": [
    {
      "type": "button",
      "name": "Button",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Button Label",
          "default": "Shop Now"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Button Link"
        },
        {
          "type": "select",
          "id": "button_style",
          "label": "Button Style",
          "options": [
            { "value": "m-button--primary", "label": "Primary" },
            { "value": "m-button--secondary", "label": "Secondary" },
            { "value": "m-button--white", "label": "White" },
            { "value": "m-button--link", "label": "Link" }
          ],
          "default": "m-button--primary"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Split Banner",
      "blocks": [
        {
          "type": "button"
        }
      ]
    }
  ]
}
{% endschema %}
